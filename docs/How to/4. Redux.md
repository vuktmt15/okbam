# Redux
Trong dá»± Ã¡n sáº½ dÃ¹ng redux Ä‘á»ƒ trao Ä‘á»•i dá»¯ liá»‡u giá»¯a cÃ¡c component vá»›i nhau hoáº·c Ä‘á»ƒ lÆ°u trá»¯ state cho sá»­ dá»¥ng cho viá»‡c khÃ¡c

Base sáº½ sá»­ dá»¥ng redux toolkit Ä‘á»ƒ viá»‡c khai bÃ¡o Ä‘á»¡ váº¥t váº£ hÆ¡n

## 1. Khai bÃ¡o
Táº¡o file vá»›i tÃªn lÃ  `Chá»©c nÄƒng + Slice` trong thÆ° má»¥c `redux/slices`. VÃ­ dá»¥:
```
ğŸ“¦redux
 â”£ ğŸ“‚slices
 â”ƒ â”£ ğŸ“œUserSlice.tsx
 â”ƒ â”£ ğŸ“œMenuSlice.tsx
```

Trong file UserSlice sáº½ cÃ³ ná»™i dung nhÆ° sau:
```tsx
import {createSlice, PayloadAction} from "@reduxjs/toolkit";
import {IAccountInfo} from "../../types";

// Khai bÃ¡o initValue
const initialState: IAccountInfo = {};

const UserSlice = createSlice({
  name: "user", //NÃªn Ä‘áº·t theo chá»©c nÄƒng
  initialState, //GiÃ¡ trá»‹ khá»Ÿi táº¡o
  reducers: { //Táº¡o cÃ¡c action
    loginUser: (_, action: PayloadAction<IAccountInfo>) => {
      return action.payload; // Tráº£ vá» state trong store trong trÆ°á»ng hÆ¡p nÃ y lÃ  dá»¯ liá»‡u truyá»n vÃ o khi gá»i dispatch
    },
    logoutUser: () => {
      return initialState;
    },
  },
});

// Export cÃ¡c action ra Ä‘á»ƒ sá»­ dá»¥ng
export const {loginUser, logoutUser} = UserSlice.actions;

// Export reducer Ä‘á»ƒ import trong file redux/store.tsx
export default UserSlice.reducer;
```

Trong file MenuSlice sáº½ cÃ³ ná»™i dung nhÆ° sau:
```tsx
import {createSlice} from "@reduxjs/toolkit";

// Khai bÃ¡o type cá»§a state
interface IMenuState {
  isOpen: boolean;
}

// Khai bÃ¡o initValue
const initialState: IMenuState = {
  isOpen: false,
};

const MenuSlice = createSlice({
  name: "menu", //NÃªn Ä‘áº·t theo chá»©c nÄƒng
  initialState, //GiÃ¡ trá»‹ khá»Ÿi táº¡o
  reducers: { //Táº¡o cÃ¡c action
    openMenu: (state) => {
      state.isOpen = true; //Sá»­a láº¡i state 
    },
    closeMenu: (state) => {
      state.isOpen = false; //Sá»­a láº¡i state 
    },
    toggleMenu: (state) => {
      state.isOpen = !state.isOpen; //Sá»­a láº¡i state 
    },
  },
});

// Export cÃ¡c action ra Ä‘á»ƒ sá»­ dá»¥ng
export const {openMenu, closeMenu, toggleMenu} = MenuSlice.actions;

// Export reducer Ä‘á»ƒ import trong file redux/store.tsx
export default MenuSlice.reducer;
```

## 2. Thay Ä‘á»•i state trong store

Äá»ƒ thay Ä‘á»•i state trong store thÃ¬ ta sáº½ gá»i action tÆ°Æ¡ng á»©ng khai bÃ¡o trong reducer ra trong hÃ m `dispatch`
```tsx
import {loginUser} from "../redux/slices/UserSlice"; // Import action
import store from "@app/redux/store";  // Import store
import {useDispatch} from "react-redux";  // Import hook

export default function Login(): JSX.Element {
  const dispatch = useDispatch();  // Khai bÃ¡o sá»­ dá»¥ng hook useDispatch
  
  const login = (loginData) => {
    loginMutation.mutate(loginData, {
      onSuccess: (res) => {
        dispatch(loginUser(res)); // ÄÃ¢y lÃ  cÃ¡ch dispatch dÃ¹ng hook
        store.dispatch(loginUser(res)); // ÄÃ¢y lÃ  cÃ¡ch dispatch khÃ´ng dÃ¹ng hook
      }
    })
  }
}
```

`LÆ°u Ã½: Chá»‰ sá»­ dá»¥ng cÃ¡ch dispatch khÃ´ng dÃ¹ng hook náº¿u Ä‘oáº¡n code xá»­ lÃ½ khÃ´ng náº±m trong React Component. VÃ­ dá»¥ nhÆ° api/Fetcher.tsx`

## 3. Láº¥y state trong store

Äá»ƒ láº¥y state trong store thÃ¬ dÃ¹ng `useSelector` hoáº·c `getState` tá»« store
```tsx
import store from "@app/redux/store";  // Import store
import {useSelector} from "react-redux";  // Import hook
import {IRootState} from "@app/redux/reducers/RootReducer"; // Import type cá»§a state

export default function Login(): JSX.Element {
  const user = useSelector((state: IRootState) => state.user) // Láº¥y state muá»‘n sá»­ dá»¥ng tá»« store ra
  
  const checkUserLoggedIn = () => {
    if (user.accessToken) { //ÄÃ¢y lÃ  cÃ¡ch láº¥y dÃ¹ng hook
      return true
    }
    if (store.getState().user.accessToken) { //ÄÃ¢y lÃ  cÃ¡ch láº¥y khÃ´ng dÃ¹ng hook
      return true;
    }
    return false
  }
}
```

`LÆ°u Ã½: Chá»‰ sá»­ dá»¥ng cÃ¡ch láº¥y state khÃ´ng dÃ¹ng hook náº¿u Ä‘oáº¡n code xá»­ lÃ½ khÃ´ng náº±m trong React Component. VÃ­ dá»¥ nhÆ° api/Fetcher.tsx`
